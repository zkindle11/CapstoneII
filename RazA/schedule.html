<!DOCTYPE html>
<?php include "authenticate.html"; ?>
<html lang="en">
<head>
	<meta charset="utf-8">
	<!-- css -->
	<link href="css/bootstrap.min.css" rel="stylesheet" />
	<link href="css/style.css" rel="stylesheet" />
        <link rel="stylesheet" href="//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
        
        <!-- javascript -->
        <script src="js/jquery.js"></script>
        <script src="js/jquery-ui.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script> 
            var jQ111 = $.noConflict();
            var flag = 0;
            function test() {
                var data = jQ111("#search_results").serialize();                
                jQ111.post("schedule_backend.html",data,function(server_data,status){
                    //alert('Data: ' + server_data + ' Status: ' + status);
                    update_calendar(server_data);
                });                     
            }
            
            function update_calendar(data){
                jQ111('#refresh_calendar').empty();
                jQ111('#refresh_calendar').append('<input type="hidden" value="'+data+'" name="payload">');
                jQ111('#refresh_calendar').append('<input type="hidden" value="test" name="iframe_test">');
                jQ111('#refresh_calendar').submit();
            }
            
            function add_class() {
                var data = jQ111("#add_classes").serialize();
                
                jQ111.post("schedule_backend.html",data,function(server_data,status){
                    print_queue(server_data,status);
                });
            }
            
            function remove_class() {
                var data = jQ111("#class_list").serialize();
                
                jQ111.post("schedule_backend.html",data,function(server_data,status){
                    print_queue(server_data,status);
                });
            }
            
            function refresh() {
                var data = 'print_queue=Print Queue';
                
                jQ111.post("schedule_backend.html",data,function(server_data,status){
                    print_queue(server_data,status);
                });
            }
            
            function print_queue(results, response_status) {
                if(response_status === 'success') {
                    jQ111('#queued_classes').empty();
                    jQ111('#queued_classes').append('<legend>Queued Classes:</legend>');
                    jQ111('#queued_classes').append(results);
                    if(flag === 1){
                        jQ111('#search_results').empty();
                        jQ111('#search_results').append('<input type="hidden" value="Print Calendar" name="print_calendar">');
                        flag = 0;
                    }
                }
                else {
                    alert("Data: " + results + "\nStatus: " + response_status);
                }
            }
            
            function get_classes() {
                var data = 'get_classes=Get Classes';
                
                jQ111.post("schedule_backend.html",data,function(server_data,status){
                    print_classes(server_data,status);
                });
            }
            
            function print_classes(results, response_status) {
                if(response_status === 'success' && flag === 0) {
                    jQ111('#search_results').append(results);               
                 
                    jQ111("#tabs").accordion({
                        collapsible: true,
                        heightStyle: "content"
                    });
                    flag = 1;
                }
            }
            
            function clear_queue() {
                var data = 'clear_queue=Clear Queue';
                flag = 0;
                jQ111.post("schedule_backend.html",data);
                
                jQ111('#queued_classes').empty();
                jQ111('#queued_classes').append('<legend>Queued Classes:</legend>');
                jQ111('#search_results').empty();
                jQ111('#search_results').append('<input type="hidden" value="Print Calendar" name="print_calendar">');
            } 
        </script>
        
	<!-- Theme skin -->
	<link href="skins/default.css" rel="stylesheet" />
	<title>Schedule</title>        
</head>
<body onload="refresh()">
	<div id="wrapper">
		<!-- start header -->
		<header>
			<div class="navbar navbar-default navbar-static-top">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand"><span>S</span>chedule Maker 9001</a>
				</div>
				<div class="navbar-collapse collapse ">
					<ul class="nav navbar-nav">
						<li><a href="courses.html">Enter Courses</a></li>
						<li class="active"><a href="schedule.html">Make Schedule</a></li>
						<li><a href="account.html">Account</a></li>
						<li><a href="logout.html">Log Off</a></li>
					</ul>
				</div>
			</div>
			</div>
		</header>
		<!-- end header -->
	</div> 
    
        <div style="float: left;">
            <section style="text-align: left;">
                <form id="add_classes" action="" >
                    <fieldset style="width:250px">
                        <legend>Add Classes:</legend>
                        <p>Dept. Prefix: <input type="text" name="dept" size="10"> <sub>ex. ENGL</sub></p>
                        <p>Course Nbr: <input type="text" name="class_number" size="10"> <sub>ex. 1003</sub></p>
                        <input type="hidden" value="Add Class" name="add_class">
                    </fieldset>    
                </form>             
                <button id="add_class" onclick="add_class()">Add Class</button>
                <button id="get_classes" onclick="get_classes()">Get Classes</button>                   
            </section>
            <br>
            <section  style="text-align: right;">
                <form id="class_list" action="">
                    <fieldset id="queued_classes" style="width:250px">
                        <legend>Queued Classes:</legend>
                    </fieldset>
                    <input type="hidden" value="Remove Class" name="remove_class">
                </form>
                <button id="clear_queue" onclick="clear_queue()">Clear Queue</button>
                <button id="remove_class" onclick="remove_class()">Remove Class</button>
            </section>
        </div> 
  
        <div style="float:left; text-align: left; padding-left: 20px;">
            <fieldset style="width:700px">
                <legend>Week View:</legend>
                <iframe name="calendar" src="calendar_view.html" width="700" height="400"></iframe>
            </fieldset>
            <form id="refresh_calendar" action="calendar_view.html" method="POST" target="calendar">
                <input type="hidden" value="test" name="iframe_test">
            </form>
            <form id="search_results" action="">
                <input type="hidden" value="Print Calendar" name="print_calendar">
            </form>
        </div>        
</body>
</html>

